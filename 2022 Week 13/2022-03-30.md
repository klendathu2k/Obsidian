Note: Teleworking from home today b/c heat is off in office... Plan to work from home tomorrow and commute to the lab on Friday.

- sPHENIX poduction system
	- Coming to a few design decisions...
		- What I *don't* want to do is implement a CWL/YAML workflow for every single pass of every single sPHENIX data production.  This would be cumbersome.
		- The solution I am coming to is to create a single CWL/YAML workflow that is used to wrap a *user provided shell script*.  The CWL/YAML file will
			- Setup the environment (search paths, software build level, etc...)
			- And create environment variables which the user script can pickup:
				- N events (or event range), N jobs, N files per job, unique ID for the job, input file list, unique integer (aka index, rngseed, ...) for each job, etc...
		- Currently have a CWL workflow which can run the pass1 simulation.  
		- User provides a run_xxx.sh script, and modifies the yaml file to point to the script, specify the number of events, etc...
		- This is essentially the approach taken by SUMS.  SUMS maps all of the job's parameters (N files, file list, N events, etc...) onto environment variables which the user can pickup / apply in their shell script.
		- This gets us to the point where we can execute one single linear workflow.
		- To build up dependent behaviors, will need to implement as CWL workflows that invoke the generic workflows with user scripts to provide the inputs.  The more complicated workflows ... may or may not be generalized in the way that the linear workflows are.
	- There are two ways to scatter jobs
		- specify --nJobs option to prun
			- should be able to just add the "additional arguements" field as an option in the YAML file.  will need to provide default and make optional?
		- scatter over a list of inputs using the CWL syntax
	- pchain is once more not working (I see some work going on behind the scenes vis a vis rucio... so perhaps not unexpected?)
	- ... possibly b/c setting username requires Javascript... (there is an issue with bash syntax and CWL javascript expression syntax clashing...)

- May have shot myself in the .foot... cloned the CWL runner reference github repo... and ran one of the test suites... it complied my local CWL (not an issue), but then also ran pip install on numerours packages.  So...
	- prun still working.  good.


- With the above model... I ought to be able to setup a test framework independent of PanDA... If I utilize CWL's scatter facility... can make the filelist connection.
	- But probably want to be able to use PanDA's nJobs option as well...  


Have the following proof-of-concept:
```
cwl-runner shrek.cwl run_hfcharm_pass1.yaml
```

``` run_hfcharm_pass1.yaml

# Specifies a unique name for the job                                  
jobname: g4charm                                                                                                     
# Extra panda flags (such as number of jobs to run)                                                                                      
extra_panda_args: --nJobs 5                                                                                                              
                                                                                                                                         
# sPHENIX software build level                                                                                                           
build: mdc2.7                                                                                                                            
nevents: 100                                                                                                                             
type: Charm                                                                                                                              
outfile: TestSubmission                                                                                                                  
outdir: /sphenix/user/sphnxpro/shrek/pass1/out                                                                                           
logdir: /sphenix/user/sphnxpro/shrek/pass1/log                                                                                           
jobdir: /sphenix/u/jwebb2/work/2022/SHREK/MDC2                                                                                           
                                                                                                                                         
runnumber: 1234567890                                                                                                                    
                                                                                                                                         
# Commands to stage files required to run the code                                                                                       
stagecmd: |-                                                                                                                             
  ln -s /sphenix/u/jwebb2/work/2022/SHREK/MDC2/submit/HF_pp200_signal/pass1/rundir/* .                                                   
                                                                                                                                         
# Command block                                                                                                                          
commands: |-                                                                                                                             
  echo execute a predefined script                                                                                                       
  run_hfprod_pass1.sh                                                                                                                    
  echo or any arbitrary set of unix commands...                                                                                          
  # e.g. root.exe -q -b Fun4All.C                                                                                                        
                                                                                                                                         
# Copy back block                                                                                                                        
copyback: |-                                                                                                                             
  ls > g4charm_$RUNNUM_$SEQNUM.manifest     

```
	

[[STAR S&C Meeting 03-30-2022]]
- Victor's github journey...
- [PR #335](https://github.com/star-bnl/star-sw/pull/335/files)
	- Contains geometry updates...
	- Incoming action item:
		- Geometry PR to be split off... will setup seperate geometry EtofGeo1.xml and retag.
		- Dumb question (for the review) will be how reproducible is mounting the poletip onto the east side of STAR... have we unmounted / remounted during the time with the ETOF in STAR?  (I think not...)
		- 



