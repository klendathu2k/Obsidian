## Monday 04/04/2022

- [ ] 0830AM [NPPS Coffee](https://bnl.zoomgov.com/j/16157150845?pwd=NXNqTi9ZWEFBKzYwRXQ5U3NXU1dBZz09)

sPhenix Production System / SHREK

- Tadashi replied to email... essentially stating that CWL is limited b/c of reasons... Asking why I need the feature to support the initial work dir requirement...
	- Seems to imply that the problem is already solved...  
	- ... actually, no.  pchain allows us to send an arbitrary payload.  This is fine, but not quite what I want to do..  What I want is a single source description of the job.  CWL is a natural way to express the job, but I need the PanDA to respect the InitialWorkDIr requirement...
	- Another option is discussed below...

- Answer is
	- Separation of concerns.  CWL file should specify the workflow for a job, it should be defined once and never touched again.  

- %IN resolves to a list that can be used as input to a script... but how..  run a quick test...
	- Documentation says it all... the %IN field provides the files in a dataset which have been made available by (in our case) rucio.  
	- This is not suitable for transmitting the job configuration information

What about a plan B?

Plan A is to submit a CWL file which is generic, and takes the full job description from the YAML file.  Requires PanDA to respect the InitialWorkDir requirement in the CWL specification.

Plan B... do not use pchain directly.  Instead, we run a CWL runner which takes a YAML file specifying the job definition.  The CWL file will be responsible for making the call to pchain.  It would need to be responsible for 


Better understanding of the file mechanism ... 

```
prun --inDS ...
```

specifies the input data set which has been staged by rucio to the remote resource.

```
prun --secondaryDSs REF1:NPerF1:NAME1,...,REFn:NPerFn:NAMEn
```

specifies N secondary data sets, where REF1...REFn are the %REF1 references the user can specify in the --exec field.


