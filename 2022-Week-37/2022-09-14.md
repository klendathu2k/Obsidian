## Wednesday {{date}}

- [ ] 0830AM [NPPS Coffee](https://bnl.zoomgov.com/j/16157150845?pwd=NXNqTi9ZWEFBKzYwRXQ5U3NXU1dBZz09)
- [ ] 1000AM [sPHENIX Distributed Computing](https://bnl.zoomgov.com/j/16157150845?pwd=NXNqTi9ZWEFBKzYwRXQ5U3NXU1dBZz09)
- [ ] 1200PM [STAR S&C Meeting](https://lbnl.zoom.us/j/97026562983?pwd=VGVXbzhYUUhheEJ2cFMyVVdVRXowZz09)

Switching things up to an actor model... when a dataset matches, forward the name of the DS to a script.  And let the script do the shrek submission... (and documentation? and etc...)...

Basically start to loosely couple things.  shrek (submit) to become (only) a high level interface to PanDA / pchain.   donkey (watch) checks for dataset in rucio and dispatches to user defined scripts, which can call other services... (e.g. shrek to dispatch to PanDA).  

But first have to make the damn thing work... and right now, sh.Command does not seem to be executed...

... okay, something seems to be swallowing the output.  Por que?

... can capture stdout, stderr and forward to functions... this works.  And is a useful feature.

```
donkey --submit  --match '*sP22s*CharmSimu*.tar' --period=3600 --startdate='2022-08-03' --actor submitToPanda --prescale 5
Verifying  submitToPanda
[Donkey 2022-09-14 15:46:38.588698 polling datasets since 2022-08-03 : 6 datasets match : updated_at>2022-08-03]
Action:  submitToPanda user.jwebb2.sP22s-hfcharm-signal-test1_000_Pythia8CharmSimulation
Action:  submitToPanda user.jwebb2.sP22s-hfcharm-signal-test10_000_Pythia8CharmSimulation
```

Time for a proper test submission...

Using uuid's could be problematic b/c... I see the following error when running the check on the submission...

`The name of an output or log dataset container (user.jwebb2.sP22s-hfcharm-pileup-donkey-5-3b171a3b-3446-11ed-b6f4-00163e101048_002_Pythia8Pass4TrackStage0_Pythia8Pass4TrackStage0.outDS.tar/) is too long (141). The length must be less than 132 following DDM definition. Please note that one dataset container is creted per output/log type and each name is <outDS>_<extension made from the output filename>/ or <outDS>.log/.`

So... likely the job is being swallowed...